var selectedPhotoIndex=-1;var selectedPhotoId=-1;var selectedImageUrl="";var isWebcam=false;var js;function clearImage(){if(isWebcam){var A="/friend/photos/deleteMostRecentUpload.do";jQuery.get(A,{js:js,photoId:document.getElementById("webcamImg").name},function(B){});}document.getElementById("commentImage").innerHTML="";document.getElementById("imagehidden").value="";document.getElementById("trash").style.display="none";}function displayPhotoLink(){photoLink=new hi5.Lightbox("photoLink",document.getElementById("photo_link").innerHTML,{acceptText:"Open",onAccept:function(){},styleClass:"photoLink",loadText:"Loading...",cancelText:"Cancel",onCancel:function(){}});}function submitLink(A){document.getElementById("commentImage").innerHTML='<img style="overflow:auto" src="'+document.getElementById("linkText").value+'"/>';document.getElementById("imagehidden").value='<img style="overflow:auto" src="'+document.getElementById("linkText").value+'"/>';document.getElementById("trash").style.display="block";isWebcam=false;closeLinkLightbox();}function closeLinkLightbox(){closelb("photoLink");}function showChoosePhotoLightbox(){ChoosePhoto=new hi5.Lightbox("ChoosePhoto",document.getElementById("choose_photo").innerHTML,{acceptText:"Open",onAccept:function(){},styleClass:"choosePhotoContent",loadText:"Loading...",cancelText:"Cancel",onCancel:function(){}});}function displayAlbumPhotos(){var A="/friend/photos/displayChoosePhotoFromAlbumAjax.do";new Ajax.Updater({success:"choose_photo"},A,{asynchronous:false,evalScripts:true,onFailure:function(B,C){alert("Error!");},onSuccess:function(B,C){document.getElementById("choose_photo").style.display="none";}});}function paginate4(C,A){var B="/friend/photos/displayChoosePhotoFromAlbumAjax.do?offset="+C+"&albumId="+A;new Ajax.Updater({success:"aaaa"},B,{asynchronous:false,onFailure:function(D,E){alert(D.responseText);},evalScripts:true});}function selectPhoto(D,A,B,C){if(selectedPhotoIndex!=-1){document.getElementById("image"+selectedPhotoIndex).style.opacity="1";document.getElementById("image"+selectedPhotoIndex).style.filter="alpha(opacity=100)";}document.getElementById("image"+D).style.opacity="0.4";document.getElementById("image"+D).style.filter="alpha(opacity=40)";selectedPhotoIndex=D;selectedPhotoId=A;selectedImageUrl=B;selectedFuid=C;submitPhoto();}function submitPhoto(){document.getElementById("commentImage").innerHTML='<img  style="overflow:auto" src="'+selectedImageUrl+'"/>';document.getElementById("imagehidden").value='<img style="overflow:auto" src="'+selectedImageUrl+'"/>';isWebcam=false;document.getElementById("trash").style.display="block";closePhotoLightbox();}function closePhotoLightbox(){closelb("ChoosePhoto");}function closelb(lbstr){var lb=eval(lbstr);lb.close();return false;}function createAlbum(){document.getElementById("select-album").style.display="none";document.getElementById("create-album").style.display="";document.upload.type.value="1";}function selectAlbum(){document.getElementById("create-album").style.display="none";document.getElementById("select-album").style.display="";document.upload.type.value="0";}function displayAjaxUploader(){var A="/friend/photos/displayUploadPhotos.do";jQuery.get(A,{fromProfile:"fromProfile"},function(B){document.getElementById("ajax_uploader").innerHTML=B;AjaxUploader=new hi5.Lightbox("AjaxUploader",document.getElementById("ajax_uploader").innerHTML,{acceptText:"Open",onAccept:function(){},styleClass:"ajaxUploader",loadText:"Loading...",cancelText:"Cancel",onCancel:function(){}});document.getElementById("ajax_uploader").style.display="none";});}function webcamUploadDone(A){if(A=="success"){var B="/friend/photos/getMostRecentUpload.do";jQuery.get(B,{},function(C){document.getElementById("commentImage").innerHTML=C;document.getElementById("imagehidden").value=C;document.getElementById("trash").style.display="block";isWebcam=true;closeUploadLightbox();});}}function displayWebcamUploader(B){js=B;var A="/friend/photos/webcamProfile.do";jQuery.get(A,{},function(H){document.getElementById("ajax_uploader").innerHTML=H;AjaxUploader=new hi5.Lightbox("AjaxUploader",document.getElementById("ajax_uploader").innerHTML,{acceptText:"Open",onAccept:function(){},styleClass:"webcamUploader",loadText:"Loading...",cancelText:"Cancel",onCancel:function(){}});document.getElementById("ajax_uploader").style.display="none";var G=document.getElementById("kval").innerHTML;var F=document.getElementById("timestamp").innerHTML;var D=document.getElementById("albumid").innerHTML;var I=document.getElementById("server").innerHTML;var J={AllowScriptAccess:"always",wmode:"opaque"};var E={id:"FlashFilesUpload",name:"FlashFilesUpload",wmode:"opaque"};var C={uploadUrl:"/friend/photos/uploadPhotos.do",type:"0",kval:G,server:I,timestamp:F,setCode:"true",Id:"-1",albumId:D};swfobject.embedSWF("http://static.hi5.com/webcam_mini3.swf","webcam","320","320","8.0.0",false,C,J,E);});}function closeUploadLightbox(){closelb("AjaxUploader");}var totalSucceeded=0;var totalFailed=0;function addImage(){var A=document.getElementById("iframe");$j(A).bind("load",function(){var C=$(this).contentDocument;try{if(C.body.innerHTML!=null&&C.body.innerHTML!=""){var B=YAHOO.lang.JSON.parse(C.body.innerHTML);if(B.uploadResponse.status=="fail"){totalFailed++;}else{totalSucceeded++;}C.body.innerHTML="";if(totalSucceeded+totalFailed==totalSubmitted){nextPage(totalSucceeded,B.uploadedPhotos.fullURL);}}}catch(D){if(this.src.indexOf("success")>0){totalSucceeded++;}else{totalFailed++;}if(totalSucceeded==1){totalSucceeded=0;nextPage(totalSucceeded,this.src.substring(this.src.indexOf("link=")+5,this.src.indexOf("&s")));}}});document.getElementById("uploadForm").target="iframe";document.getElementById("uploadForm");document.getElementById("uploadForm").submit();}function nextPage(B,A){document.getElementById("commentImage").innerHTML='<img  style="overflow:auto" src="'+A+'"/>';document.getElementById("imagehidden").value='<img style="overflow:auto" src="'+A+'"/>';document.getElementById("trash").style.display="block";isWebcam=false;closeUploadLightbox();}